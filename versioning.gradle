ext {
  major = project.property('artifactMajorVersion')
  minor = project.property('artifactMinorVersion')
  patch = 'DEV'

  getVersionCode = {
    if (rootProject.hasProperty('teamcity')) {
      teamcity['build.major'] = major
      teamcity['build.minor'] = minor
  
      if (teamcity['build.number'].contains('.')) {
        patch = teamcity['build.number'].split('\\.')[2]
      } else {
        patch = teamcity['build.number']
      }

      print '##teamcity[buildNumber \'' + major + '.' + minor + '.' + patch + '\']'
    } else {
      ext.env = System.getenv()
      def buildNumber = env.BUILD_NUMBER?.toInteger()
      if (buildNumber) {
        patch = buildNumber
        println '##jenkins[buildNumber \'' + major + '.' + minor + '.' + patch + '\']'
      }
    }

    return major + '.' + minor + '.' + patch
  }

}
